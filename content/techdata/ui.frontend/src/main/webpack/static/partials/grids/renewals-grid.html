<div data-observe-mutation>
  <div
    data-component="RenewalsGrid"
    data-cmp-type="react"
    className="cmp-renewals-grid"
  ></div>
</div>
<script>
  const renewalsGridDom = document.querySelector(
    "[data-component='RenewalsGrid']"
  );
  const AEM_DATA = {
    detailUrl:
      "/content/techdata/americas-language-masters/en/dcp/renewals/renewal-details",
    uiServiceEndPointExcel: "",
    exportPDFRenewalsEndpoint: 'http://localhost:3000/ui-export/v1/downloadRenewalQuotePdf',
    exportXLSRenewalsEndpoint:"http://localhost:3000/ui-export/v1/downloadRenewalQuoteDetails",
    updateRenewalOrderEndpoint:"http://localhost:3000/ui-renewal/v1/Update",
    getStatusEndpoint:"http://localhost:3000/ui-renewal/v1/getStatus",
    orderRenewalEndpoint:"http://localhost:3000/ui-renewal/v1/order",
    menuCopy:'Copy',
    menuCopyWithHeaders:'Copy with headers',
    menuExport:'Export',
    columnList: [
      {
        columnLabel: "Reseller name",
        columnKey: "resellername",
        sortable: true,
        type: "plainResellerColumn",
      },
      {
        columnLabel: "End user name",
        columnKey: "endUser",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Vendor and program",
        columnKey: "vendor",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Quote Nº",
        columnKey: "Id",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Agreement Nº",
        columnKey: "agreementNumber",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Renewal Plan",
        columnKey: "renewedduration",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Due in (days)",
        columnKey: "dueDays",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Due Date",
        columnKey: "dueDate",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Price",
        columnKey: "total",
        sortable: true,
        type: "plainText",
      },
      {
        columnLabel: "Actions",
        columnKey: "actions",
        sortable: false,
        type: "buttonList",
      },
    ],
    searchOptionsList: [
      {
        searchLabel: "Serial Nº",
        searchKey: "SerialNumber",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "Quote Nº",
        searchKey: "Id",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "Agreement Nº",
        searchKey: "ContractID",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "Instance Nº",
        searchKey: "Instance",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "End-User Name",
        searchKey: "EndUser",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "End-User Email Address",
        searchKey: "EndUserEmail",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "Reseller Name",
        searchKey: "ResellerName",
        showIfIsHouseAccount: true,
      },
      {
        searchLabel: "Vendor Quote ID",
        searchKey: "VendorQuoteID",
        showIfIsHouseAccount: false,
      },
      {
        searchLabel: "Reseller Account",
        searchKey: "ResellerId",
        showIfIsHouseAccount: true,
      },
    ],
    renewalDetailsEndpoint: "http://localhost:3000/ui-renewal/v1/Details",
    uiServiceEndPoint:
      "http://localhost:3000/ui-renewal/v1/Search",
    shopURL: "https://shop.cstenet.com/renewals",
    agGridLicenseKey:
      "CompanyName=Tech Data Corporation,LicensedGroup=1602297,LicenseType=MultipleApplications,LicensedConcurrentDeveloperCount=25,LicensedProductionInstancesCount=2,AssetReference=AG-036821,SupportServicesEnd=16_March_2024_[v2]_MTcxMDU0NzIwMDAwMA==bc4bd0ff633ce8a7dc0be1551198da2b",
    itemsPerPage: "25",
    paginationStyle: "scroll",
    options: {
      defaultSortingColumnKey: "dueDate",
      defaultSortingDirection: "asc",
    },
    showResultLabel: "Show Result",
    filterType: "dynamic",
    filterListValues: [
      {
        accordionLabel: "Vendors and Program",
        filterField: "ProgramName",
        filterOptionsValues: [
          {
            filterOptionLabel: "Veeam",
            subFilterOptionsValues: [
              { subFilterOptionsLabel: "Pro Partner" },
              { subFilterOptionsLabel: "Pro Partner Subscriber" },
            ],
          },
          {
            filterOptionLabel: "VMWare",
            subFilterOptionsValues: [
              { subFilterOptionsLabel: "Support and Subscriber" },
              { subFilterOptionsLabel: "Standard" },
            ],
          },
        ],
      },
      {
        accordionLabel: "End User Type",
        filterField: "endUserType",
        filterOptionsValues: [
          { filterOptionLabel: "Academic" },
          { filterOptionLabel: "Educational" },
        ],
      },
      { accordionLabel: "Date", filterField: "date" },
    ],
    productGrid: {
      quoteIdLabel: "Quote ID:",
      refNoLabel: "Ref No:",
      expiryDateLabel: "Expiry Date:",
      downloadPDFLabel: "Download PDF",
      showDownloadPDFButton: true,
      downloadXLSLabel: "Download XLS",
      showDownloadXLSButton: true,
      seeDetailsLabel: "See details",
      showSeeDetailsButton: true,
      multipleLabel: "Multiple"
    },
    icons: {
      overdue: { overdueIcon: "fas fa-bell", overdueIconColor: "#CD163F" },
      "0-30": {
        afterZeroIcon: "fas fa-alarm-clock",
        afterZeroIconColor: "#F7B500",
      },
      "31-60": {
        afterThirtyIcon: "fas fa-clock",
        afterThirtyIconColor: "#38853C",
      },
      "61+": { sixtyPlusIcon: "calendar", sixtyPlusIconColor: "#006FBA" },
    },
    dateOptionValues: [
    { label: "Overdue", field: "overdue" },
    { label: "Today", field: "today" },
    { label: "0 - 30 days", field: "30" },
    { label: "31 - 60 days", field: "60" },
    { label: "61 - 90 days", field: "90" },
    { label: "91+ days", field: "91" },
    { label: "Custom date range", field: "custom" },
    ],
    displayCurrencyName: true,
    enableShareOption: true,
    disableDefaultSort: true,
    orderingFromDashboard:{
      showOrderingIcon: true,
      placeOrderDialogTitle:'To continue placing your order for ({enduser-companyname}) please provide the following information.',
      termsAndConditions:"I have read and accept Terms & Conditions",
      termsAndConditionsLink:"https://www.techdata.com/content/visitor/abouttd/conditions.aspx",
      successSubmission:"Your order has been successfully submitted for processing. You will receive an email once processing is complete",
      failedSubmission:"Please try again. If the error persists please contact us at ({email})",
      noResponseMessage: "We are sorry, your order could not be processed, please try again later."
    },
    hideExportOption: false,
    hideCopyHeaderOption: false,
    searchResultsError: {
      noResultsTitle: "No Results Found",
      noResultsDescription: "There are no results for your search criteria. Adjust your search and filter choices to improve results.",
      noResultsImage: "/content/dam/tds-site/tds-site-shared/error-icons/search-error-tds.png",
      noDataTitle: "No Results Found",
      noDataDescription: "There are no active renewals quotes at this time.",
      noDataImage: "/content/dam/tds-site/tds-site-shared/error-icons/search-error-tds.png"
    },
    shareFlyout: {
      "shareFlyoutTitle": "Share Testing",
      "shareFlyoutDescription": "Input the emails of whom you would like to share this quote with, and any additional comments you would like to add to the email.",
      "shareFlyoutQuoteButtonLabel": "View Quote Test",
      "shareFlyoutSignatureLabel": "Kindly Regards,",
      "shareFlyoutQuoteDescription": "View quotes related to this agreement along with any applicable upsell options. Use the Revise Quote option from the dashboard menu to send a member of our team a message if you require any further assistance.",
      "shareFlyoutButtonLabel": "Share Test",
      "shareFlyoutCommentCountText": "characters left",
      "shareFlyoutCommentCount": "500",
      "emailPreviewDescription": "Email Preview"
    },
    copyFlyout: {
      title: "Copy",
      description: "Select the reseller to whom you want to copy the renewal. If the account does not have the correct accreditation, it does not appear in the list.",
      resellerAccountLabel: "Reseller account № or name",
      searchLabel: "Search",
      searchPlaceholder: "Search by account number ",
      selectedAccountLabel: "Selected Account",
      accountNumberLabel: "Account number:",
      accountNameLabel: "Account Name:",
      cityLabel: "City:",
      permissionsWarning: "Ensure you have the appropriate permissions before copying this quote to another customer. It contains sensitive contact and commercial information. If you have any doubt please speak with you manager.",
      unknownError: "Unknown error has occurred. Please try again.",
      quoteExistsError: "Quote exists, please try again with another account.",
      accountDoesntExistError: "Account doesn't exist!",
      copySuccessMessage: "Copy quote successfully requested. You will receive an email when new quote is ready.",
      copyFailureMessage: "Your quote failed to copy. Open a ticket for further investigation.",
      button: "Copy",
      accountLookUpEndpoint:"http://localhost:3000/ui-renewal/v1/AccountLookUp?SearchInput={reseller-id}",
      checkQuoteExitsforResellerEndpoint:"http://localhost:3000/ui-renewal/v1/SearchCheck?ResellerId={reseller-id}&WithPaginationInfo=true&ContractID={agreement-number}",
      copyQuoteEndpoint:"http://localhost:3000/ui-renewal/v1/CopyQuote",
    }
  };
  renewalsGridDom.dataset.config = JSON.stringify(AEM_DATA);
</script>
